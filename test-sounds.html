<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sleevo - Test Suoni ASMR</title>
    <style>
        body {
            font-family: system-ui, -apple-system, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        h1 {
            text-align: center;
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        .subtitle {
            text-align: center;
            opacity: 0.8;
            margin-bottom: 40px;
        }
        .sound-card {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 20px;
            border: 2px solid rgba(255,255,255,0.2);
        }
        .sound-title {
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .sound-desc {
            opacity: 0.9;
            margin-bottom: 20px;
            line-height: 1.6;
        }
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 1.1em;
            cursor: pointer;
            font-weight: bold;
            margin-right: 10px;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }
        button:active {
            transform: translateY(0);
        }
        .controls {
            background: rgba(0,0,0,0.3);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 30px;
        }
        .slider-container {
            margin-bottom: 15px;
        }
        .slider-label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input[type="range"] {
            width: 100%;
            height: 8px;
            border-radius: 5px;
            background: rgba(255,255,255,0.2);
            outline: none;
        }
        .value-display {
            display: inline-block;
            background: rgba(255,255,255,0.2);
            padding: 2px 8px;
            border-radius: 4px;
            margin-left: 10px;
        }
        .emoji {
            font-size: 1.2em;
        }
        .comparison {
            background: rgba(255,200,0,0.2);
            border-left: 4px solid gold;
            padding: 15px;
            margin-top: 15px;
            border-radius: 8px;
        }
    </style>
</head>
<body>
    <h1>üéß Test Suoni ASMR</h1>
    <p class="subtitle">Sleevo Vinyl Shop Manager - Sistema Audio Migliorato</p>

    <div class="controls">
        <div class="slider-container">
            <label class="slider-label">
                üîä Volume
                <span class="value-display" id="volumeDisplay">80%</span>
            </label>
            <input type="range" id="volumeSlider" min="0" max="100" value="80">
        </div>
    </div>

    <div class="sound-card">
        <div class="sound-title">
            <span class="emoji">üéµ</span>
            Vinyl Slide (Cardboard Scrape)
        </div>
        <div class="sound-desc">
            Suono ASMR realistico di un vinile che scivola sul cartone.
            <strong>Nuovo:</strong> 600ms con texture variabile, crackle, multi-filter per carattere organico.
        </div>
        <button onclick="playVinylSlide()">‚ñ∂Ô∏è Play Vinyl Slide</button>

        <div class="comparison">
            <strong>Migliorie:</strong> Volume +80%, durata +50%, texture dinamica con crescendo/decrescendo, burst di crackle realistici, 3 filtri (low/band/high) per carattere cartone autentico.
        </div>
    </div>

    <div class="sound-card">
        <div class="sound-title">
            <span class="emoji">üéØ</span>
            Vinyl Thunk (Wood Impact)
        </div>
        <div class="sound-desc">
            Suono soddisfacente di un vinile che atterra su legno.
            <strong>Nuovo:</strong> 5 layer sovrapposti (impact + bass + mid + overtone + noise) per risonanza realistica.
        </div>
        <button onclick="playVinylThunk()">‚ñ∂Ô∏è Play Vinyl Thunk</button>

        <div class="comparison">
            <strong>Migliorie:</strong> 5 oscillatori invece di 3, bass profondo a 95Hz, risonanza lunga, overtone sottile a 850Hz, noise texture, durata +30%.
        </div>
    </div>

    <div class="sound-card">
        <div class="sound-title">
            <span class="emoji">üîÑ</span>
            Combo Test
        </div>
        <div class="sound-desc">
            Ascolta la sequenza completa: Slide ‚Üí Thunk (simulazione drop del vinile)
        </div>
        <button onclick="playCombo()">‚ñ∂Ô∏è Play Combo (Slide + Thunk)</button>
    </div>

    <script>
        let audioContext;
        let volume = 0.8;

        // Initialize audio context on first user interaction
        function initAudio() {
            if (!audioContext) {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
            }
        }

        // Volume control
        document.getElementById('volumeSlider').addEventListener('input', (e) => {
            volume = e.target.value / 100;
            document.getElementById('volumeDisplay').textContent = e.target.value + '%';
        });

        // Vinyl Slide - ENHANCED
        function playVinylSlide() {
            initAudio();
            const ctx = audioContext;
            const duration = 0.6;
            const now = ctx.currentTime;

            // Create noise buffer with varying intensity
            const bufferSize = ctx.sampleRate * duration;
            const buffer = ctx.createBuffer(1, bufferSize, ctx.sampleRate);
            const data = buffer.getChannelData(0);

            for (let i = 0; i < bufferSize; i++) {
                const t = i / bufferSize;
                const envelope = Math.sin(t * Math.PI) * 0.6;
                const crackle = Math.random() > 0.97 ? Math.random() * 0.4 : 0;
                data[i] = (Math.random() * 2 - 1) * envelope + crackle;
            }

            const noise = ctx.createBufferSource();
            noise.buffer = buffer;

            // Multi-stage filtering
            const lowPass = ctx.createBiquadFilter();
            lowPass.type = 'lowpass';
            lowPass.frequency.value = 2800;
            lowPass.Q.value = 0.5;

            const bandPass = ctx.createBiquadFilter();
            bandPass.type = 'bandpass';
            bandPass.frequency.value = 1600;
            bandPass.Q.value = 3;

            const highShelf = ctx.createBiquadFilter();
            highShelf.type = 'highshelf';
            highShelf.frequency.value = 4000;
            highShelf.gain.value = -6;

            const gainNode = ctx.createGain();
            gainNode.gain.setValueAtTime(0, now);
            gainNode.gain.linearRampToValueAtTime(volume * 0.45, now + 0.05);
            gainNode.gain.exponentialRampToValueAtTime(volume * 0.35, now + duration * 0.3);
            gainNode.gain.exponentialRampToValueAtTime(0.01, now + duration);

            noise.connect(lowPass);
            lowPass.connect(bandPass);
            bandPass.connect(highShelf);
            highShelf.connect(gainNode);
            gainNode.connect(ctx.destination);

            noise.start(now);
            noise.stop(now + duration);
        }

        // Vinyl Thunk - ENHANCED
        function playVinylThunk() {
            initAudio();
            const ctx = audioContext;
            const now = ctx.currentTime;

            // Impact transient
            const impact = ctx.createOscillator();
            const impactGain = ctx.createGain();
            impact.type = 'triangle';
            impact.frequency.value = 180;
            impactGain.gain.setValueAtTime(volume * 0.5, now);
            impactGain.gain.exponentialRampToValueAtTime(0.01, now + 0.05);
            impact.connect(impactGain);
            impactGain.connect(ctx.destination);
            impact.start(now);
            impact.stop(now + 0.05);

            // Body resonance
            const body1 = ctx.createOscillator();
            const body1Gain = ctx.createGain();
            body1.type = 'sine';
            body1.frequency.value = 95;
            body1Gain.gain.setValueAtTime(volume * 0.4, now + 0.01);
            body1Gain.gain.exponentialRampToValueAtTime(0.01, now + 0.45);
            body1.connect(body1Gain);
            body1Gain.connect(ctx.destination);
            body1.start(now + 0.01);
            body1.stop(now + 0.45);

            // Mid-range wood character
            const body2 = ctx.createOscillator();
            const body2Gain = ctx.createGain();
            body2.type = 'triangle';
            body2.frequency.value = 240;
            body2Gain.gain.setValueAtTime(volume * 0.25, now + 0.015);
            body2Gain.gain.exponentialRampToValueAtTime(0.01, now + 0.35);
            body2.connect(body2Gain);
            body2Gain.connect(ctx.destination);
            body2.start(now + 0.015);
            body2.stop(now + 0.35);

            // Overtone
            const overtone = ctx.createOscillator();
            const overtoneGain = ctx.createGain();
            overtone.type = 'sine';
            overtone.frequency.value = 850;
            overtoneGain.gain.setValueAtTime(volume * 0.15, now + 0.005);
            overtoneGain.gain.exponentialRampToValueAtTime(0.01, now + 0.12);
            overtone.connect(overtoneGain);
            overtoneGain.connect(ctx.destination);
            overtone.start(now + 0.005);
            overtone.stop(now + 0.12);

            // Noise texture
            const noiseBuffer = ctx.createBuffer(1, ctx.sampleRate * 0.1, ctx.sampleRate);
            const noiseData = noiseBuffer.getChannelData(0);
            for (let i = 0; i < noiseData.length; i++) {
                noiseData[i] = (Math.random() * 2 - 1) * 0.3;
            }
            const noise = ctx.createBufferSource();
            noise.buffer = noiseBuffer;
            const noiseFilter = ctx.createBiquadFilter();
            noiseFilter.type = 'bandpass';
            noiseFilter.frequency.value = 600;
            noiseFilter.Q.value = 2;
            const noiseGain = ctx.createGain();
            noiseGain.gain.setValueAtTime(volume * 0.2, now);
            noiseGain.gain.exponentialRampToValueAtTime(0.01, now + 0.08);
            noise.connect(noiseFilter);
            noiseFilter.connect(noiseGain);
            noiseGain.connect(ctx.destination);
            noise.start(now);
            noise.stop(now + 0.1);
        }

        // Combo: Slide then Thunk
        function playCombo() {
            playVinylSlide();
            setTimeout(() => playVinylThunk(), 650);
        }
    </script>
</body>
</html>
