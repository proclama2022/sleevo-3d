---
phase: 04-level-content-and-mode-validation
plan: "04"
type: execute
wave: 2
depends_on:
  - "04-01"
files_modified:
  - src/components/CustomerPanel.tsx
  - src/components/HUD/HUD.tsx
autonomous: true
requirements:
  - MODE-01
  - MODE-03

must_haves:
  truths:
    - "CustomerPanel displays the customer name — e.g. 'Marco vuole: Jazz degli anni 70'"
    - "CustomerPanel falls back to 'Il cliente' when no customerName is provided"
    - "Rush urgency animation fires at 10 seconds remaining, not 30"
  artifacts:
    - path: "src/components/CustomerPanel.tsx"
      provides: "Customer panel with customerName prop"
      contains: "customerName"
    - path: "src/components/HUD/HUD.tsx"
      provides: "Rush urgency threshold corrected to 10s"
      contains: "isLowTime"
  key_links:
    - from: "src/components/CustomerPanel.tsx"
      to: "src/game/types.ts"
      via: "customerName from Level.customerName passed via GameScreen props"
      pattern: "customerName"
    - from: "src/components/HUD/HUD.tsx"
      to: "src/game/types.ts"
      via: "timeRemaining prop (rushTimeLeft from GameState)"
      pattern: "isLowTime"
---

<objective>
Two focused UI fixes that do not touch GameScreen or the engine: (1) add customerName display to CustomerPanel so it renders "Marco vuole: ..." instead of generic "Il cliente vuole: ...", and (2) fix the rush urgency threshold in HUD.tsx from 30 seconds to 10 seconds.

Purpose: These are self-contained component fixes. Running them in Wave 2 parallel with Plan 03 keeps them cleanly scoped — neither file conflicts with engine.ts.

Output: Updated CustomerPanel.tsx and HUD/HUD.tsx.
</objective>

<execution_context>
@/Users/martha2022/.claude/get-shit-done/workflows/execute-plan.md
@/Users/martha2022/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-level-content-and-mode-validation/04-CONTEXT.md
@.planning/phases/04-level-content-and-mode-validation/04-RESEARCH.md
@src/components/CustomerPanel.tsx
@src/components/HUD/HUD.tsx
@.planning/phases/04-level-content-and-mode-validation/04-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add customerName to CustomerPanel</name>
  <files>src/components/CustomerPanel.tsx</files>
  <action>
Read src/components/CustomerPanel.tsx fully before editing.

Make the following changes:

1. Add `customerName?: string` to the component's Props interface.

2. In the component's render/return, find where the customer "speech" text is rendered (the line showing what the customer wants — something like "Il cliente vuole: {genre} degli {era}"). Update it to:
   - If `customerName` is provided: render `"{customerName} vuole: {genre} degli {eraLabel}"`
   - If `customerName` is NOT provided: render `"Il cliente vuole: {genre} degli {eraLabel}"`
   - Use the null-coalescing pattern: `{customerName ?? 'Il cliente'} vuole:`

3. Do NOT change any other behavior — the panel position, animation, CSS classes, or other props stay exactly as they are.

After editing, ensure the component still compiles. The `customerName` prop is optional so all existing usages that don't pass it will continue to show "Il cliente vuole:" without breaking.
  </action>
  <verify>
    <automated>cd /Users/martha2022/Documents/Sleevo && npx tsc --noEmit 2>&1 | grep "CustomerPanel" | head -10</automated>
    <manual>Confirm CustomerPanel.tsx props interface includes customerName?: string and the speech render uses the customerName ?? 'Il cliente' pattern</manual>
    <sampling_rate>run after edit</sampling_rate>
  </verify>
  <done>CustomerPanel.tsx has customerName?: string in its Props. The rendered speech uses `{customerName ?? 'Il cliente'} vuole:`. No TypeScript errors in CustomerPanel.tsx.</done>
</task>

<task type="auto">
  <name>Task 2: Fix rush urgency threshold in HUD.tsx</name>
  <files>src/components/HUD/HUD.tsx</files>
  <action>
Read src/components/HUD/HUD.tsx fully before editing.

Find the line that defines `isLowTime`. Per the RESEARCH.md, it currently reads approximately:
```typescript
const isLowTime = timeRemaining !== undefined && timeRemaining < 30;
```

Change `< 30` to `<= 10`:
```typescript
const isLowTime = timeRemaining !== undefined && timeRemaining <= 10;
```

This is a one-line change. Do NOT modify any other logic in HUD.tsx — the TimerValue styled component, getLevelRuleDisplay, or any other function stays as-is.
  </action>
  <verify>
    <automated>cd /Users/martha2022/Documents/Sleevo && grep -n "isLowTime" /Users/martha2022/Documents/Sleevo/src/components/HUD/HUD.tsx</automated>
    <manual>Confirm the isLowTime line reads `timeRemaining <= 10` (not `< 30` or `<= 30`)</manual>
    <sampling_rate>run after edit — one-line change, verify immediately</sampling_rate>
  </verify>
  <done>HUD.tsx isLowTime uses `<= 10`. TypeScript compiles clean. The change is exactly one line.</done>
</task>

</tasks>

<verification>
Run: `cd /Users/martha2022/Documents/Sleevo && npx tsc --noEmit 2>&1 | grep -E "CustomerPanel|HUD" | head -10`
Expected: no errors from either file.

Run: `grep -n "isLowTime" /Users/martha2022/Documents/Sleevo/src/components/HUD/HUD.tsx`
Expected: line shows `<= 10`.

Run: `grep -n "customerName" /Users/martha2022/Documents/Sleevo/src/components/CustomerPanel.tsx`
Expected: at least 2 lines (Props interface + render usage).
</verification>

<success_criteria>
- CustomerPanel shows customer name using `customerName ?? 'Il cliente'` pattern
- HUD rush urgency fires at 10 seconds (not 30)
- Both files compile with zero TypeScript errors
</success_criteria>

<output>
After completion, create `.planning/phases/04-level-content-and-mode-validation/04-04-SUMMARY.md`
</output>
