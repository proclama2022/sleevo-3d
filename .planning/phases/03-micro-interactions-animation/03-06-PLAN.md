---
phase: 03-micro-interactions-animation
plan: 06
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/ShelfSlot/ShelfSlot.tsx
  - src/animations/keyframes.ts
  - src/components/VinylCard/VinylCard.tsx
autonomous: true
requirements:
  - MOTION-03

must_haves:
  truths:
    - "User sees slot highlight within 150ms when dragging vinyl over slot"
    - "User sees glow ring pulse subtly while hovering"
    - "User sees highlight fade smoothly over 200-300ms when leaving slot"
    - "User can hover multiple slots simultaneously (if card overlaps)"
  artifacts:
    - path: "src/animations/keyframes.ts"
      provides: "Glow pulse keyframe animation for hover state"
      exports: ["glowPulse", "hoverGlow"]
      min_lines: 20
    - path: "src/components/ShelfSlot/ShelfSlot.tsx"
      provides: "Hover state with fast in, slower out transitions"
      exports: ["ShelfSlot", "ShelfSlotProps"]
      min_lines: 1
  key_links:
    - from: "src/components/ShelfSlot/ShelfSlot.tsx"
      to: "src/animations/keyframes.ts"
      via: "import statement"
      pattern: "from '\\.\\.\\/animations'"
    - from: "src/components/VinylCard/VinylCard.tsx"
      to: "src/components/ShelfSlot/ShelfSlot.tsx"
      via: "drag hover state"
      pattern: "\\$isHovered"
---

# Plan 03-06: Shelf Hover State Animation

**Goal:** Add hover state animation to shelf slots with fast enter (150ms), slower exit (200-300ms), and subtle glow pulse.

**User Decision from 03-CONTEXT.md:**
> "Slot hover highlight: Glow pulse — ring + pulsing glow that intensifies as you hover over slot"

**Requirements Satisfied:** MOTION-03 (Shelf hover state with 150ms in, 200-300ms out, glow pulse)

**Current State:**
- ShelfSlot has basic hover state (instant color change)
- No glow pulse animation
- No transition timing specified

**Target State:**
- Hover enter: 150ms with fast easing
- Hover exit: 200-300ms with slower easing
- Glow pulse: Subtle ring pulsing during hover

---

<task type="auto">
  <name>Task 1: Create Glow Pulse Keyframe Animation</name>
  <files>src/animations/keyframes.ts</files>
  <action>
Create glow pulse keyframe animation for hover state:
```typescript
export const glowPulse = keyframes`
  0%, 100% {
    box-shadow: 0 0 12px rgba(74, 222, 128, 0.4),
                0 0 24px rgba(74, 222, 128, 0.2);
  }
  50% {
    box-shadow: 0 0 20px rgba(74, 222, 128, 0.6),
                0 0 40px rgba(74, 222, 128, 0.3);
  }
`;
```

Create hover glow mixin with transitions:
```typescript
export const hoverGlow = css`
  transition: all 150ms ease-out;
  animation: ${glowPulse} 2s ease-in-out infinite;

  @media (prefers-reduced-motion: reduce) {
    transition: none;
    animation: none;
  }
`;
```

Per user decision from 03-CONTEXT.md: "Slot hover highlight: Glow pulse — ring + pulsing glow that intensifies as you hover over slot"
Per requirement MOTION-03: "Duration: 150ms (enter), 200-300ms (exit)"
</action>
  <verify>glowPulse keyframe animates box-shadow from 12px/24px to 20px/40px and back. hoverGlow mixin has 150ms ease-out transition. Reduced motion support included.</verify>
  <done>Glow pulse keyframe and hover mixin created with proper timing</done>
</task>

<task type="auto">
  <name>Task 2: Add Hover State to ShelfSlot</name>
  <files>src/components/ShelfSlot/ShelfSlot.tsx</files>
  <action>
Import hoverGlow mixin from animations. Add $isHovered prop to ShelfSlotProps interface (optional boolean).

Apply hover state styling:
```typescript
${(props) => props.$isHovered && props.$state === 'empty' && css`
  border: 2px solid rgba(74, 222, 128, 0.8);
  background: linear-gradient(180deg, rgba(74, 222, 128, 0.1) 0%, rgba(74, 222, 128, 0.05) 100%);
  ${animations.hoverGlow}
`}

${(props) => !props.$isHovered && props.$state === 'empty' && css`
  transition: all 250ms ease-in;
  border: 2px solid rgba(255, 255, 255, 0.1);
  background: linear-gradient(180deg, rgba(0, 0, 0, 0.6) 0%, rgba(0, 0, 0, 0.8) 100%);
`}
```

Note: 250ms ease-in for exit is within 200-300ms requirement. The hoverGlow mixin provides 150ms ease-out for enter.

Per user decision from 03-CONTEXT.md: "Hover states: Instant color switch — instant color change, no transition" (for reduced motion)
Per requirement MOTION-03: "Easing: ease-out (enter), ease-in (exit)"
</action>
  <verify>ShelfSlot accepts $isHovered prop. Hover state applies green border/glow with 150ms ease-out. Exit transition is 250ms ease-in. Only applies when state is 'empty'.</verify>
  <done>Hover state added to ShelfSlot with fast in, slower out timing</done>
</task>

<task type="auto">
  <name>Task 3: Wire Hover State via Drag Collision Detection</name>
  <files>src/components/VinylCard/VinylCard.tsx</files>
  <action>
Add collision detection callback to VinylCard's drag handler. The hover state is managed by parent component (GameScreen), but VinylCard must report position during drag.

Add `onDragMove` callback to VinylCardProps interface:
```typescript
onDragMove?: (position: {x: number, y: number}) => void;
```

Call this callback during drag movement:
```typescript
handleDragMove = (event: DragEvent) => {
  const position = { x: event.clientX, y: event.clientY };
  props.onDragMove?.(position);
  // ... existing drag logic
}
```

The parent component (GameScreen) will:
1. Receive position updates via onDragMove
2. Check collision with each ShelfSlot using getBoundingClientRect()
3. Pass isHovered prop to ShelfSlot based on collision

Per user decision from 03-CONTEXT.md: "Slot hover highlight: Glow pulse — ring + pulsing glow that intensifies as you hover over slot"
</action>
  <verify>VinylCardProps has onDragMove callback. handleDragMove calls onDragMove with clientX/clientY coordinates. Parent component can use position to detect slot collisions.</verify>
  <done>Hover position reporting added to drag handler for collision detection</done>
</task>

---

## Success Criteria

- [ ] Slot highlights within 150ms when card hovers over it
- [ ] Glow pulse animates subtly (2s duration, infinite loop)
- [ ] Highlight fades over 200-300ms when card leaves slot
- [ ] Multiple slots can highlight simultaneously
- [ ] Reduced motion mode skips animations (instant color switch)

---

## Testing Checklist

- [ ] Drag vinyl over slot → verify highlight appears within 150ms
- [ ] While hovering → verify glow pulse animates
- [ ] Drag card away → verify highlight fades over 200-300ms
- [ ] Drag card over multiple slots → verify all hovered slots highlight
- [ ] Enable reduced motion → verify instant color switch, no pulse
- [ ] Test on mobile → verify hover works with touch drag

---

## Files Modified

- `src/animations/keyframes.ts` - Add glowPulse keyframe and hoverGlow mixin
- `src/components/ShelfSlot/ShelfSlot.tsx` - Add hover state with $isHovered prop
- `src/components/VinylCard/VinylCard.tsx` - Wire hover detection in drag handler

---

## Dependencies

**Depends on:** None (can run in parallel with 03-01, 03-02, 03-03, 03-04)

**Blocks:** None (independent feature)

## Phase

**Phase:** 03-micro-interactions-animation
**Plan:** 06
**Type:** execute

---

## Notes

- 150ms enter provides instant feedback
- 250ms exit prevents jarring disappearance
- Glow pulse is subtle (2s duration) to avoid distraction
- Multiple slots can hover (useful for large cards or close slots)
