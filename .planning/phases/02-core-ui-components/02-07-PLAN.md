---
phase: 02-core-ui-components
plan: "02-07"
type: execute
wave: 1
depends_on: []
files_modified:
  - src/App.tsx
  - src/components/GameScreen.tsx
autonomous: true
gap_closure: true
requirements:
  - COMP-03
  - COMP-04
  - A11Y-01

must_haves:
  truths:
    - "User sees a transparent (semi-opaque backdrop-blur) bar at the top of the game screen showing Score, Moves, and progress gauge"
    - "User sees a circular SVG progress gauge centered in the top bar (not the dot-style ProgressBar)"
    - "User sees Score, Moves count — no Level name in the HUD bar"
    - "The old InfoPanel row (infoRow) is replaced by the new HUD component"
  artifacts:
    - path: "src/components/GameScreen.tsx"
      provides: "GameScreen importing and rendering HUD/HUD.tsx"
      contains: "import.*HUD"
  key_links:
    - from: "src/components/GameScreen.tsx"
      to: "src/components/HUD/HUD.tsx"
      via: "import { HUD } from './HUD/HUD'"
      pattern: "import.*HUD.*from.*HUD"
    - from: "src/components/GameScreen.tsx"
      to: "src/components/HUD/HUD.tsx"
      via: "rendered as <HUD ...> in JSX"
      pattern: "<HUD "
---

<objective>
Wire `HUD/HUD.tsx` into `GameScreen.tsx`, replacing the existing `InfoPanel` / `infoRow` status display with the new transparent HUD bar that has a circular progress gauge centered between Score (left) and Timer+Moves (right).

Purpose: HUD.tsx was built correctly but is orphaned — GameScreen never imports or renders it. Users see the old InfoPanel components instead of the locked design decisions (transparent bar, circular gauge, no level name).

Output: `GameScreen.tsx` imports and renders `<HUD>` at the top of the screen, computing the correct props from existing game state. The old `infoRow` div and InfoPanel imports are removed from GameScreen (InfoPanel may still be imported if used elsewhere in that file — verify before removing).
</objective>

<execution_context>
@/Users/martha2022/.claude/get-shit-done/workflows/execute-plan.md
@/Users/martha2022/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-core-ui-components/02-VERIFICATION.md
@src/App.tsx
@src/components/GameScreen.tsx
@src/components/HUD/HUD.tsx
@src/components/GameScreen.module.css
@src/ui/ThemeProvider.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Replace InfoPanel infoRow with HUD component in GameScreen</name>
  <files>src/components/GameScreen.tsx</files>
  <action>
    Wire HUD into GameScreen by making these changes:

    1. **Add HUD import** at the top of GameScreen.tsx imports section:
       ```
       import { HUD } from './HUD/HUD';
       ```

    2. **Compute progress prop** — HUD needs `progress: number` (0-100). Derive it from existing state:
       ```
       const progress = state.level.vinyls.length > 0
         ? Math.round((Object.keys(state.placedVinyls).length / state.level.vinyls.length) * 100)
         : 0;
       ```
       Add this after the existing `const level = state.level;` line.

    3. **Compute timeRemaining prop** — HUD accepts optional `timeRemaining?: number`. Map from rush mode:
       ```
       const hudTimeRemaining = state.level.mode === 'rush' ? state.rushTimeLeft : undefined;
       ```

    4. **Replace the `<div className={styles.infoRow}>` block** (the entire block from `<div className={styles.infoRow}>` through its closing `</div>`) with:
       ```jsx
       <HUD
         score={state.score}
         moves={state.moves}
         progress={progress}
         timeRemaining={hudTimeRemaining}
       />
       ```
       Place this as the FIRST child inside the `.screen` div, before `<SceneBackdrop>`.

    5. **Remove the InfoPanel import** if InfoPanel is no longer referenced anywhere else in GameScreen.tsx. Check the entire file for `InfoPanel` before removing. If it still appears (e.g., in another part of the JSX), keep the import.

    6. **Do NOT remove `InstructionPill`** — it is still used in the JSX and must remain.

    7. **Existing flat ProgressBar** (`import { ProgressBar } from './ProgressBar'` on line 17) renders at the bottom of the game screen (`<ProgressBar total=... placed=...>`). This is a separate progress bar below the shelf showing placed count. Keep it as-is — the HUD uses the circular ProgressBar internally, and this flat dot-style one is a secondary visual indicator in a different location. Do not remove it.

    Layout note: HUD uses `position: fixed; top: 0` so it will float above the game screen. The existing `.screen` div has `overflow: hidden` and `padding: 18px 15px 12px`. Add `paddingTop` adjustment if needed — add a top padding spacer or adjust `.screen` padding to `padding: 72px 15px 12px` to prevent HUD from covering game content. Check HUD height: HUD has `padding: theme.spacing.md theme.spacing.lg` which is approx 48px tall. Add inline style or CSS adjustment:
    - In `GameScreen.module.css`, add to the `.screen` rule: `padding-top: 72px;` (replace the `18px` top padding).
    - Also add for mobile: In the `@media (max-width: 520px)` block, update `.screen` to add `padding-top: max(72px, calc(env(safe-area-inset-top) + 60px));`

    **CRITICAL: Wire ThemeProvider in App.tsx** — `src/App.tsx` currently just renders `<GameScreen />` with no ThemeProvider. The HUD (and all styled-components using `props.theme`) requires ThemeProvider in the tree. Update `src/App.tsx`:
    ```tsx
    import { ThemeProvider } from './ui/ThemeProvider';
    import { GameScreen } from './components/GameScreen';

    export default function App() {
      return (
        <ThemeProvider>
          <GameScreen />
        </ThemeProvider>
      );
    }
    ```
    This is prerequisite for HUD to render without `undefined` theme errors.
  </action>
  <verify>
    1. `npx tsc --noEmit` — zero new TypeScript errors
    2. `npm run dev` — dev server starts without error
    3. Grep confirms HUD is imported: `grep "import.*HUD" src/components/GameScreen.tsx`
    4. Grep confirms HUD is rendered: `grep "<HUD" src/components/GameScreen.tsx`
    5. Grep confirms infoRow div is gone: `grep "infoRow" src/components/GameScreen.tsx` — should return empty or reference only the CSS class (no JSX usage)
  </verify>
  <done>
    GameScreen.tsx imports HUD from './HUD/HUD'.
    `<HUD score=... moves=... progress=... timeRemaining=...>` renders as the first element inside the screen div.
    The old `<div className={styles.infoRow}>` containing two InfoPanel components is removed.
    TypeScript compiles clean. Dev server starts.
    Screen padding accounts for fixed HUD height (paddingTop ~72px).
  </done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` — zero new errors
2. `npm run build` — build succeeds
3. `grep -n "import.*HUD\|<HUD" src/components/GameScreen.tsx` — both import and render present
4. `grep -n "infoRow" src/components/GameScreen.tsx` — not used in JSX (only referenced via styles object if CSS class still exists)
5. `grep -n "InfoPanel" src/components/GameScreen.tsx` — either removed or confirmed unused
</verification>

<success_criteria>
- HUD component renders at top of GameScreen with score, moves, progress, and optional timer
- Circular progress gauge (from ProgressBar/ProgressBar.tsx via HUD) is visible in the center of the top bar
- Old InfoPanel infoRow is removed from GameScreen JSX
- No TypeScript errors, build succeeds
- Game content is not covered by the fixed HUD (padding-top adjusted)
</success_criteria>

<output>
After completion, create `.planning/phases/02-core-ui-components/02-07-SUMMARY.md`
</output>
